# 🔄 문맥 교환 & 인터럽트 & 멀티태스킹

---

## ✅ 문맥 교환 (Context Switching)

문맥 교환이란 CPU가 **다른 프로세스/스레드로 전환**될 때  
현재 실행 중이던 프로세스의 상태(Context)를 저장하고,  
새로운 프로세스의 상태를 복원하는 과정입니다.

```text
[프로세스 A 실행 중]
   ↓ 인터럽트 발생 or 시간 종료
[프로세스 A 상태 저장 (PCB)]
   ↓
[프로세스 B 상태 복원 (PCB)]
   ↓
[프로세스 B 실행 시작]
```

- 상태 저장/복원에는 레지스터, 프로그램 카운터, 스택 포인터 등이 포함됩니다.
- 문맥 교환은 오버헤드가 존재하며, 스레드 간 전환이 더 빠릅니다.

---

## ✅ 인터럽트 (Interrupt)

인터럽트는 **외부 장치나 내부 예외** 등이 발생했을 때,  
CPU에게 처리 중단을 요청하는 **비동기 신호**입니다.

### 📌 인터럽트 종류

| 종류 | 설명 |
|------|------|
| **하드웨어 인터럽트** | 키보드 입력, 타이머, 네트워크 등 |
| **소프트웨어 인터럽트** | 예외 상황 (0으로 나누기 등), 시스템 콜 |

### 📌 인터럽트 처리 과정

```text
[사용자 프로세스 실행 중]
  ↓
[인터럽트 발생]
  ↓
[현재 상태 저장 → 커널 모드 전환]
  ↓
[인터럽트 핸들러 동작]
  ↓
[이전 상태 복원 → 사용자 모드 복귀]
```

---

## ✅ 멀티태스킹 (Multitasking)

멀티태스킹이란 **하나의 CPU가 여러 작업을 번갈아 수행**하는 개념입니다.

> 사용자 입장에서는 여러 프로그램이 동시에 동작하는 것처럼 보임.

### 📌 선점형 vs 비선점형

| 구분 | 설명 |
|------|------|
| **선점형** | 운영체제가 강제로 CPU를 회수 (타이머 인터럽트 기반) |
| **비선점형** | 프로세스가 자발적으로 CPU 양보 |

### 📌 관련 기술

- **문맥 교환**: 멀티태스킹의 핵심 기법
- **CPU 스케줄링**: 어떤 프로세스에게 CPU를 줄지 결정

---

## ✅ 핵심 요약

- **문맥 교환**: 실행 중인 프로세스를 저장하고 전환
- **인터럽트**: 외부/내부 신호로 인한 처리 개입
- **멀티태스킹**: CPU가 여러 프로세스를 동시에 실행하는 것처럼 보이게 만듦

---
## ✅ CPU가 여러 프로세스를 처리할 때의 전체 흐름

> 사용자는 여러 프로그램을 동시에 실행하지만,  
> 실제 CPU는 한 순간에 **하나의 작업만 처리** 가능하므로  
> 이를 빠르게 번갈아 처리함 (→ **멀티태스킹**).

---

1️⃣ **멀티태스킹 시작**  
- OS는 여러 프로세스를 동시에 실행 중인 것처럼 보이게 함  
- CPU는 **일정 시간(Time Slice)** 동안 한 프로세스만 실행

---

2️⃣ **인터럽트 발생**  
- 타이머 또는 입출력 이벤트 등으로 인해  
  현재 실행 중인 프로세스를 **중단**해야 할 때 발생  
- 인터럽트가 발생하면 OS는 **문맥 교환** 준비

---

3️⃣ **문맥 교환 (Context Switching)**  
- 현재 프로세스의 **상태(레지스터, PC 등)를 저장**  
- 다음 실행할 프로세스의 **이전 상태를 복원**  
- 이 과정은 **커널 모드**에서 수행됨  
  (즉, 시스템이 CPU 제어권을 직접 관리)

---

4️⃣ **새로운 프로세스 실행**  
- 상태가 복원된 새 프로세스가 CPU에서 실행됨  
- 이후 또 다른 인터럽트가 발생하면 위 과정 반복


> 사용자 입장에서는 CPU가 여러 프로그램이 동시에 실행되는 것처럼 느껴지는 이유는
> **멀티태스킹 + 인터럽트 + 문맥 교환**이 함께 작동한 결과!
---