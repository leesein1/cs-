# 📌 인덱스 (Index)

---

## ✅ 인덱스란?

> 데이터베이스에서 **데이터 검색 속도를 높이기 위한 자료구조**입니다.

- 책의 찾아보기(index)와 같은 역할
- 특정 컬럼에 대한 값을 빠르게 찾을 수 있도록 도와줌
- **SELECT 성능 향상**의 핵심 도구

---

## 🔍 왜 인덱스를 사용할까?

- 대용량 데이터에서 원하는 값을 **빠르게 찾기 위해**
- 특정 컬럼 기준으로 정렬하거나 조건 검색할 때 효과적
- **쿼리 성능 최적화**에 필수

---

## 🧱 인덱스의 구조

- 대부분의 DBMS는 **B-Tree 인덱스** 사용
- 정렬된 트리 구조로 되어 있어 탐색 속도가 빠름
- 그 외에도 **Hash 인덱스**, **Bitmap 인덱스** 등 존재

---

## 🛠️ 인덱스의 종류

| 종류 | 설명 |
|------|------|
| 기본 인덱스 | 기본 키(PK)에 자동 생성되는 인덱스 |
| 고유 인덱스 | 중복을 허용하지 않는 인덱스 |
| 복합 인덱스 | 2개 이상의 컬럼으로 구성된 인덱스 |
| 비트맵 인덱스 | 낮은 유일도를 가진 컬럼에 적합 (Oracle) |
| 함수 기반 인덱스 | 특정 함수 결과에 인덱스를 생성 |

```sql
CREATE TABLE Users (
    user_id INT,
    user_name VARCHAR(100),
    email VARCHAR(100) UNIQUE,               -- 고유 인덱스
    phone VARCHAR(20),
    ssn VARCHAR(20),
    ssn2 VARCHAR(20),                        -- 쉼표 누락 수정
    CONSTRAINT uq_ssn_pair UNIQUE (ssn, ssn2),   -- 복합 고유 인덱스
    CONSTRAINT pk_user PRIMARY KEY (user_id, user_name)  -- 복합 기본키
);

/* 예시를 위한 테이블로 실제 이렇게 사용하지는 않는다.*/
```

---

## 🧩 클러스터드 vs 비클러스터드 인덱스

| 구분 | 클러스터형 인덱스 (Clustered Index) | 비클러스터형 인덱스 (Non-clustered Index) |
|------|-------------------------------------|--------------------------------------------|
| 구조 | **데이터 자체를 정렬**된 형태로 저장 | 별도의 인덱스 페이지에 포인터로 저장 |
| 저장 방식 | 테이블 자체가 인덱스 | 인덱스는 따로, 데이터는 별도로 존재 |
| 인덱스 수 | **하나만 생성 가능** | 여러 개 생성 가능 |
| 성능 | 범위 조회에 강함 (예: `BETWEEN`, `ORDER BY`) | 특정 조건 탐색에 유리 (예: `WHERE`, `JOIN`) |
| 예시 | 기본키(PK)에 자주 사용 | 자주 조회되는 서브컬럼에 사용 |


> 클러스터드의 경우 보통 **PK**에 부여 되며, Select 시 물리적으로는 삽입 순서를 지키지만, Index는 정렬되어 저장된다.  
> ( ex. 3 - 1 - 2 - 4 순서로 INSERT 시 물리 적으로는 3 - 1 - 2 - 4, INDEX는 1 - 2 - 3 - 4 형태로 저장 )


> 비클러스터드 인덱스는 별도의 인덱스 구조로 정렬된 키 + 데이터 주소를 저장하며,  
> 조회 시 인덱스를 통해 정렬된 키를 탐색 후 → 테이블 원본 주소로 점프한다.  
> (예: abs 컬럼 인덱스 → 정렬된 abs 값 + 각 행 주소 기억)

---

### 🔎 그림으로 요약

```
📘 Clustered Index (데이터 자체가 정렬됨)
[10] → [20] → [30] → [40] (데이터 자체가 정렬됨)

📘 Non-Clustered Index (포인터를 가리킴)
[20] → 주소(3행)
[40] → 주소(7행)
→ 그 주소로 이동하여 데이터 가져옴
```

---

## ⚠️ 인덱스 사용 시 주의점

- **쓰기(INSERT/UPDATE/DELETE) 성능 저하** 가능성
- 너무 많은 인덱스는 오히려 역효과
- **자주 조회되는 컬럼**, **조건절에 자주 등장하는 컬럼** 위주로 설정

---

## ✅ 실무 팁

- WHERE, JOIN, ORDER BY 절에서 자주 쓰는 컬럼에 인덱스 적용
- 너무 자주 바뀌는 컬럼에는 주의
- 인덱스보다 먼저 **쿼리 튜닝**부터 점검할 것

---

## 🧠 요약

```

인덱스는 테이블 내 데이터를 빠르게 찾기 위한 구조이며, SELECT 성능 향상에 매우 중요하다.
하지만 INSERT/UPDATE에는 부하가 될 수 있으므로, 빈도와 패턴에 맞게 전략적으로 사용해야 한다.

```
